# Prometheus/Grafana bookstore monitoring

>–†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ —Ö–æ—Å—Ç–æ–≤–æ–π –º–∞—à–∏–Ω—ã, –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —à–∞–±–ª–æ–Ω–Ω–æ–≥–æ —Å–∞–π—Ç–∞ —Å –ø–æ–º–æ—â—å—é Docker Compose.

### –ò—Å—Ö–æ–¥–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
–í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤–∑—è—Ç PHP/MySQL —Å–∞–π—Ç, —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–π —Å –ø–æ–º–æ—â—å—é Docker –≤ –ø—Ä–æ–µ–∫—Ç–µ `github.com/Qikxiji/PHP_MySQL_bookstore_deploy`

### –°—Ç–µ–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
- Prometheus - —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞. –°–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ —Å Nginx, MySQL –∏ —Ö–æ—Å—Ç–∞ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –ø—Ä–æ–≥—Ä–∞–º–º-—ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–æ–≤.
- Grafana - –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Prometheus –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö. –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏, —Å–æ–±–∏—Ä–∞–µ–º—ã–µ –∏ —Ö—Ä–∞–Ω–∏–º—ã–µ Prometheus –≤ –≤–∏–¥–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤, —Å—á—ë—Ç—á–∏–∫–æ–≤, –∏–∑–º–µ—Ä–∏—Ç–µ–ª–µ–π –∏ –¥—Ä. 

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:

```
$PROJECT_ROOT
‚îÇ  
‚îú‚îÄ‚îÄ db  
‚îÇ  ‚îú‚îÄ‚îÄ database.sql             # —Å–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î —Ç–æ–≤–∞—Ä–æ–≤ –∏ —É—á—ë—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ  ‚îú‚îÄ‚îÄ Dockerfile               # —Ñ–∞–π–ª —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞ mysql, –¥–æ–ø–æ–ª–Ω–µ–Ω–Ω—ã–π —Å –ø–æ–º–æ—â—å—é database.sql –∏ exporter_user.sql
‚îÇ  ‚îú‚îÄ‚îÄ exporter_user.sql        # —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ —Å mtsql
‚îÇ  ‚îú‚îÄ‚îÄ root_password.sql        # —Ñ–∞–π–ª —Å –ø–∞—Ä–æ–ª–µ–º –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è root, –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –≤–∏–¥–µ docker secret
‚îÇ  
‚îú‚îÄ‚îÄ grafana
‚îÇ  ‚îú‚îÄ‚îÄ datasource.yml           # —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ  ‚îú‚îÄ‚îÄ grafana.db               # –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å –≥–æ—Ç–æ–≤—ã–º–∏ –¥–∞—à–±–æ—Ä–¥–∞–º–∏ –¥–ª—è nginx, mysql –∏ —Ö–æ—Å—Ç–∞
‚îÇ  
‚îú‚îÄ‚îÄ nginx
‚îÇ  ‚îú‚îÄ‚îÄ bookstore/               # –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –ø—Ä–æ–µ–∫—Ç–æ–º —Å–∞–π—Ç–∞ –Ω–∞ php
‚îÇ  ‚îú‚îÄ‚îÄ 5-php-fpm_entrypoint.sh  # —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ php-fpm, –∑–∞–≥—Ä—É–∂–∞–µ–º—ã–π –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä nginx
‚îÇ  ‚îú‚îÄ‚îÄ Dockerfile               # —Ñ–∞–π–ª —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞ nginx, –¥–æ–ø–æ–ª–Ω–µ–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç–æ–º —Å–∞–π—Ç–∞, php-fpm –∏ —Ñ–∞–π–ª–∞–º–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ nginx
‚îÇ  ‚îú‚îÄ‚îÄ nginx.conf               # —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ nginx
‚îÇ  ‚îú‚îÄ‚îÄ php_site.conf            # —Ñ–∞–π–ª –≥–ª–æ–±–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ nginx
‚îÇ
‚îú‚îÄ‚îÄ prometheus
‚îÇ  ‚îú‚îÄ‚îÄ mysql_exporter_cnf       # —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è mysql —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–∞
‚îÇ  ‚îú‚îÄ‚îÄ prometheus.yml           # —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ prometheus
‚îÇ  
‚îú‚îÄ‚îÄ compose.yaml                # —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ nginx, mysql, prometheus, grafana, node_exporter, nginx_exporter, mysql_exporter
```
## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
1. –í —Ä–∞–±–æ—Ç—É –±—ã–ª –ø—Ä–∏–Ω—è—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–Ω–æ–≥–æ —Å–∞–π—Ç–∞ `github.com/Qikxiji/PHP_MySQL_bookstore_deploy`.
2. –ü–æ–ª—É—á–µ–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –±—ã–ª –¥–æ–ø–æ–ª–Ω–µ–Ω —Å–∏—Å—Ç–µ–º–æ–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ Prometheus –∏ Grafana. –í—ã–ø–æ–ª–Ω–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
 - –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –æ–±—ä–µ–∫—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –∏–º–∏ —Å—Ç–∞–ª–∏: —Ö–æ—Å—Ç–æ–≤–∞—è –º–∞—à–∏–Ω–∞ (–º–æ–Ω–∏—Ç–æ—Ä—è—Ç—Å—è —Ä–µ—Å—É—Ä—Å—ã –û–ó–£, –¶–ü–£, –¥–∏—Å–∫–∞, —Å–µ—Ç–∏ –∏ —Ç.–¥.), –≤–µ–±-—Å–µ—Ä–≤–µ—Ä Nginx(—Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π), —Å–µ—Ä–≤–µ—Ä MySQL (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –∑–∞–ø—Ä–æ—Å—ã, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ç—å –∏ –¥—Ä.).
 - –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞: prometheus –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫, node exporter, nginx exporter –∏ mysql exporter –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫, grafana –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö. 
 - –í –ø—Ä–æ–µ–∫—Ç Docker Compose –¥–æ–±–∞–≤–ª–µ–Ω—ã –æ–±—Ä–∞–∑—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ Prometheus, Grafana, node exporter, nginx exporter –∏ mysql exporter.
 -  –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ —Å–µ—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. –°–æ–∑–¥–∞–Ω—ã –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–º–∞ –∏ —Ç–æ–º–∞ bind mount –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, –∞ —Ç–∞–∫–∂–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã. –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ prometheus –∏ nginx_exporter (–¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏), –∞ —Ç–∞–∫–∂–µ mysql_exporet (–¥–ª—è —Ä–∞—à–∏—Ä–µ–Ω–∏—è –Ω–∞–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫).
 - –°–æ—Å—Ç–∞–≤–ª–µ–Ω—ã —Ñ–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ prometheus (prometheus.yml), grafana (datasource.yml) –∏ mysql_exporter (mysql_exporter_cnf).
 - –í–Ω–µ—Å–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª—ã nginx (php_site.conf) –¥–ª—è —Ä–∞–±–æ—Ç—ã nginx_exporter, —Å–æ–∑–¥–∞–Ω –∏ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ –æ–±—Ä–∞–∑ mysql —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è mysql_exporter –∫ mysql.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞:
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker, Compose –æ–±—ã—á–Ω–æ –∏–¥–µ—Ç –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ.

## –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

- –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π 

```bash
git clone https://github.com/Qikxiji/... .
```  

- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–æ—Ä–Ω–µ–≤—É—é –ø–∞–ø–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (—Å —Ñ–∞–π–ª–æ–º compose.yaml), —Å–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥–æ–π: 
```bash
docker compose up -d
```
–ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Å–±–æ—Ä–∫–∞ –≤—Å–µ—Ö –æ–±—Ä–∞–∑–æ–≤ (–æ–±—â–∏–π –æ–±—ä–µ–º –æ–±—Ä–∞–∑–æ–≤ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 2073 –ú–±) –∏ –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∑–∞–π–º–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è.

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
 - [localhost:8080](http://localhost:8080) ‚îÄ –≤–µ–±-—Å–∞–π—Ç
 - [localhost:9090](http://localhost:9090) ‚îÄ prometheus
 - [localhost:3000](http://localhost:3000) ‚îÄ grafana (<u>login: admin password: grafana</u>, –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å –≤ —Ñ–∞–π–ª–µ compose.yaml)



## üì∏ Screenshots:
- –°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –∏ –ø—Ä–æ–±—Ä–æ—Å–∞ –ø–æ—Ä—Ç–æ–≤

<img src=".git_img/containers.png" width="490px">

- –û—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ —Å–∞–π—Ç–∞

<img src=".git_img/site.png" width="900px">

- –û–∫–Ω–æ —Ü–µ–ª–µ–π —Å–∫—Ä–µ–π–ø–∏—Ä–æ–≤–∞–Ω–∏—è prometheus [localhost:9090/targets](http://localhost:9090/targets)

<img src=".git_img/prometh.png" width="900px">

- –û–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –¥–∞—à–±–æ—Ä–¥–∞ –≤ Grafana [localhost:3000/dashboards](http://localhost:3000/dashboards)

<img src=".git_img/dashboards.png" width="900px">

- –î–∞—à–±–æ—Ä–¥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ —Ö–æ—Å—Ç–æ–≤–æ–π –º–∞—à–∏–Ω—ã

<img src=".git_img/node_dash.png" width="1100px">

- –î–∞—à–±–æ—Ä–¥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ Nginx

<img src=".git_img/nginx_dash.png" width="1100px">

- –î–∞—à–±–æ—Ä–¥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ MySQL —Å–µ—Ä–≤–µ—Ä–∞

<img src=".git_img/mysql_dash.png" width="1100px">
